<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AWS Control Tower Account Factory for Terraform</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/white.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/highlight/monokai.css">

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        .reveal section { text-align: left; }
        .reveal section.center { text-align: center; }
        .reveal h1 { color: #232f3e; margin-bottom: 20px; }
        .reveal h2 { color: #ff9900; }
        .reveal strong { color: #ff9900; }
        .reveal .slide-number { background: #232f3e; color: #fff; }
        /* Ensure Mermaid diagrams don't overflow */
        .mermaid { display: flex; justify-content: center; }
        .mermaid svg { max-height: 450px !important; width: auto !important; }
    </style>
</head>

<body>

<div class="reveal">
    <div class="slides">

        <section class="center" data-background-color="#232f3e">
            <h1 style="color:white">AWS Control Tower</h1>
            <h2 style="color:#ff9900">Account Factory for Terraform</h2>
            <p style="color:#ccc">Complete Implementation Guide</p>
        </section>

        <section data-markdown="slides/00-prerequisites.md"
                 data-separator="^\n---\n$"
                 data-separator-vertical="^\n\*\*\*\n$"
                 data-charset="utf-8"></section>

        <section data-markdown="slides/01-introduction.md"
                 data-separator="^\n---\n$"
                 data-separator-vertical="^\n\*\*\*\n$"></section>

        <section data-markdown="slides/02-architecture.md"
                 data-separator="^\n---\n$"
                 data-separator-vertical="^\n\*\*\*\n$"></section>

        <section data-markdown="slides/03-workflow.md"
                 data-separator="^\n---\n$"
                 data-separator-vertical="^\n\*\*\*\n$"></section>

        <section data-markdown="slides/04-customisations.md"
                 data-separator="^\n---\n$"
                 data-separator-vertical="^\n\*\*\*\n$"></section>

        <section data-markdown="slides/05-demo.md"
                 data-separator="^\n---\n$"
                 data-separator-vertical="^\n\*\*\*\n$"></section>

        <section data-markdown="slides/06-work-done.md"
                 data-separator="^\n---\n$"
                 data-separator-vertical="^\n\*\*\*\n$"></section>

        <section class="center" data-background-color="#232f3e">
            <h1 style="color:white">Questions?</h1>
            <p style="color:#aaa">Letâ€™s discuss</p>
        </section>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/markdown/markdown.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/highlight/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/notes/notes.js"></script>

<script>
    // Initialize Mermaid with settings that play nice with Reveal
    mermaid.initialize({
        startOnLoad: false,
        theme: 'base',
        themeVariables: { primaryColor: '#ff9900', edgeLabelBackground: '#ffffff' },
        securityLevel: 'loose'
    });

    let deck = new Reveal({
        hash: true,
        slideNumber: 'c/t',
        controls: true,
        progress: true,
        center: false,
        transition: 'slide',
        plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
    });

    deck.initialize().then(() => {
        renderMermaid();
    });

    // Renders mermaid diagrams within the current slide context
    function renderMermaid() {
        const diagrams = document.querySelectorAll('.mermaid:not([data-processed="true"])');
        diagrams.forEach((diagram, i) => {
            const id = `mermaid-${Math.floor(Math.random() * 1000)}`;
            mermaid.render(id, diagram.textContent).then(({ svg }) => {
                diagram.innerHTML = svg;
                diagram.setAttribute('data-processed', 'true');
            });
        });
    }

    // Re-run mermaid on slide changes to catch any newly revealed diagrams
    deck.on('slidechanged', () => {
        renderMermaid();
    });
</script>

</body>
</html>