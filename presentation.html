<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AWS Control Tower Account Factory for Terraform</title>

    <!-- Reveal core -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/white.css">

    <!-- Highlight theme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/highlight/monokai.css">

    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        .reveal section { text-align: left; }
        .reveal section.center { text-align: center; }
        .reveal h1 { color: #232f3e; }
        .reveal h2 { color: #ff9900; }
        .reveal strong { color: #ff9900; }
        .reveal .slide-number { background: #232f3e; color: #fff; }
        .reveal .mermaid svg { max-height: 360px; }
    </style>
</head>

<body>

<div class="reveal">
    <div class="slides">

        <!-- TITLE -->
        <section class="center" data-background-color="#232f3e">
            <h1 style="color:white">AWS Control Tower</h1>
            <h2>Account Factory for Terraform</h2>
            <p style="color:#ccc">Complete Implementation Guide</p>
        </section>

        <!-- ✅ FIX 1: ORDER (Prereqs first, then Intro) -->
        <!-- ✅ FIX 2: separators now tolerant: ^---\s*$ -->

        <section data-markdown="slides/00-prerequisites.md"
                 data-separator="^---\\s*$"
                 data-separator-vertical="^\\*\\*\\*\\s*$"
                 data-separator-notes="^Note:"
                 data-charset="utf-8"></section>

        <section data-markdown="slides/01-introduction.md"
                 data-separator="^---\\s*$"
                 data-separator-vertical="^\\*\\*\\*\\s*$"
                 data-separator-notes="^Note:"
                 data-charset="utf-8"></section>

        <section data-markdown="slides/02-architecture.md"
                 data-separator="^---\\s*$"
                 data-separator-vertical="^\\*\\*\\*\\s*$"
                 data-separator-notes="^Note:"
                 data-charset="utf-8"></section>

        <section data-markdown="slides/03-workflow.md"
                 data-separator="^---\\s*$"
                 data-separator-vertical="^\\*\\*\\*\\s*$"
                 data-separator-notes="^Note:"
                 data-charset="utf-8"></section>

        <section data-markdown="slides/04-customisations.md"
                 data-separator="^---\\s*$"
                 data-separator-vertical="^\\*\\*\\*\\s*$"
                 data-separator-notes="^Note:"
                 data-charset="utf-8"></section>

        <section data-markdown="slides/05-demo.md"
                 data-separator="^---\\s*$"
                 data-separator-vertical="^\\*\\*\\*\\s*$"
                 data-separator-notes="^Note:"
                 data-charset="utf-8"></section>

        <section data-markdown="slides/06-work-done.md"
                 data-separator="^---\\s*$"
                 data-separator-vertical="^\\*\\*\\*\\s*$"
                 data-separator-notes="^Note:"
                 data-charset="utf-8"></section>

        <!-- CLOSING -->
        <section class="center" data-background-color="#232f3e">
            <h1 style="color:white">Questions?</h1>
            <p style="color:#aaa">Let’s discuss</p>
        </section>

    </div>
</div>

<!-- Reveal core -->
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.js"></script>

<!-- Plugins -->
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/markdown/markdown.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/highlight/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/notes/notes.js"></script>

<script>
    // Convert ```mermaid blocks (from markdown) into <div class="mermaid">...</div>
    function renderMermaid(scope = document) {
      const blocks = scope.querySelectorAll('pre code.language-mermaid, pre code.mermaid');
      blocks.forEach(code => {
        const div = document.createElement('div');
        div.className = 'mermaid';
        div.textContent = code.textContent;
        code.parentElement.replaceWith(div);
      });

      const mermaidNodes = scope.querySelectorAll('.mermaid');
      if (mermaidNodes.length > 0) {
        mermaid.initialize({ startOnLoad: false, securityLevel: 'loose' });
        mermaid.run({ nodes: Array.from(mermaidNodes) });
      }
    }

    Reveal.initialize({
      hash: true,
      slideNumber: true,
      controls: true,
      progress: true,
      center: false,

      // makes arrow navigation feel “PowerPoint-like”
      navigationMode: 'linear',

      plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
    }).then(() => {
      renderMermaid();
    });

    Reveal.on('slidechanged', event => {
      renderMermaid(event.currentSlide);
    });
</script>

</body>
</html>